{
  "metainfo" : {
    "id" : "1",
    "language" : "python",
    "fabricId" : "990",
    "frontEndLanguage" : "sql",
    "mode" : "batch",
    "udfs" : {
      "language" : "python",
      "udfs" : [ ]
    },
    "udafs" : {
      "language" : "python",
      "code" : ""
    },
    "configuration" : {
      "common" : {
        "type" : "record",
        "fields" : [ ]
      },
      "oldCommon" : {
        "type" : "record",
        "fields" : [ ]
      },
      "fabrics" : { },
      "instances" : { },
      "selected" : "default",
      "nonEditable" : [ ],
      "isSubscribedPipelineWithPipelineConfigs" : false
    },
    "sparkConf" : [ ],
    "hadoopConf" : [ ],
    "codeMode" : "sparse",
    "buildSystem" : "maven",
    "externalDependencies" : [ ],
    "isImported" : false,
    "interimMode" : "Full",
    "interimModeEnabled" : true,
    "visualCodeInterimMode" : "Disabled",
    "recordsLimit" : {
      "enabled" : false,
      "value" : 100
    },
    "topLevelPackage" : "pricingbysegment"
  },
  "connections" : [ {
    "id" : "msDHh45okEZRwMo_7mLnQ",
    "source" : "NVq4EgexCYu3mIc-NjHCB$$Mvz2FewliukpPG0Nvu3_K",
    "sourcePort" : "qwAmYOpKWTXscld6t9gzz$$UZIlvNxKFPa1NO65Y2Y4B",
    "target" : "9fSCN0grbscwa97q59qKI$$CpZXGIhBeWCJRAcYEOYn9",
    "targetPort" : "zrK5UhFFLBsK-abtuP7Fg$$es16pY48O2Fub7WYHczkZ"
  }, {
    "id" : "mJaKjaSJNbYx0_Qc8R1Dn",
    "source" : "DesAMchieghr2sS4gP4Cj$$C7SZDqP8IFHYQ_JXwAQzw",
    "sourcePort" : "5ch4yV0S7OkxoYIXikemj$$yQEEnliTmItccOXmjMJjJ",
    "target" : "9fSCN0grbscwa97q59qKI$$CpZXGIhBeWCJRAcYEOYn9",
    "targetPort" : "aXbN0dcD-ZxUkNDYa3_I6$$xz4NGyhsEi_iSkd7Bv5ly"
  }, {
    "id" : "Argf9uGzBiFoc-8AzVICN",
    "source" : "8Mp3C9BE6TOABTp8JkZNb$$XPitnhS67-102QlrAEufe",
    "sourcePort" : "804K7Hsv2AhZpXLmz6m2b$$7M7_HKyAaQRpqhUm7V_It",
    "target" : "QHraJwix6MU4zkcR2JcAh$$1WegjhqC0sBHI7lizd57N",
    "targetPort" : "jmtRAGkFjovY3at-MWOey$$gJQQztgCLMHHZY8oVIJXo"
  }, {
    "id" : "nsXDQilU959I093LNBG9E",
    "source" : "9fSCN0grbscwa97q59qKI$$CpZXGIhBeWCJRAcYEOYn9",
    "sourcePort" : "JxRAoGF1_Bycx2nLf_myo$$dlGCSqxxQCmI1sWbqKHQo",
    "target" : "S7Uq6Rc2wMV-gAbeby4ux$$JAueZycoDSuqzLA_xqFog",
    "targetPort" : "8mYWUkw15f4mTJoUR2shi$$dKaIoa9L3vS6Zkgi-6nSm"
  }, {
    "id" : "gcpCPWxEapR_eaQhimeKx",
    "source" : "S7Uq6Rc2wMV-gAbeby4ux$$JAueZycoDSuqzLA_xqFog",
    "sourcePort" : "FRZPYqyd9qsHI8EYfpVoz$$2m-s2vKUtFKOPCzPuH4pD",
    "target" : "8Mp3C9BE6TOABTp8JkZNb$$XPitnhS67-102QlrAEufe",
    "targetPort" : "JUsR1yMs0Gr4ourpvsl56$$mc4zYqS2Q7Y-pwUhSoURn"
  } ],
  "processes" : {
    "S7Uq6Rc2wMV-gAbeby4ux$$JAueZycoDSuqzLA_xqFog" : {
      "id" : "S7Uq6Rc2wMV-gAbeby4ux$$JAueZycoDSuqzLA_xqFog",
      "component" : "Reformat",
      "metadata" : {
        "label" : "AdjustCols",
        "slug" : "AdjustCols",
        "x" : 520,
        "y" : 220,
        "phase" : 0,
        "cache" : true,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "8mYWUkw15f4mTJoUR2shi$$dKaIoa9L3vS6Zkgi-6nSm",
          "slug" : "in0",
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "FRZPYqyd9qsHI8EYfpVoz$$2m-s2vKUtFKOPCzPuH4pD",
          "slug" : "out",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "MKTSEGMENT",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "FOLLOW_UP",
              "type" : "boolean",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "QUANTITY",
              "type" : "decimal(12,2)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "EXTENDEDPRICE",
              "type" : "decimal(12,2)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "DISCOUNT",
              "type" : "decimal(12,2)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TAX",
              "type" : "decimal(12,2)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "RETURNFLAG",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "DELIVERYSTATUS",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "CLEARANCE",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "SHIPDATE",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ACCTBAL",
              "type" : "decimal(20,10)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "C_CUSTKEY",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ORDERKEY",
              "type" : "decimal(38,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true
      },
      "properties" : {
        "importLanguage" : "python",
        "expressions" : [ {
          "target" : "MKTSEGMENT",
          "expression" : {
            "format" : "sql",
            "expression" : "MKTSEGMENT"
          },
          "description" : ""
        }, {
          "target" : "QUANTITY",
          "expression" : {
            "format" : "sql",
            "expression" : "QUANTITY"
          },
          "description" : ""
        }, {
          "target" : "EXTENDEDPRICE",
          "expression" : {
            "format" : "sql",
            "expression" : "EXTENDEDPRICE"
          },
          "description" : ""
        }, {
          "target" : "DISCOUNT",
          "expression" : {
            "format" : "sql",
            "expression" : "DISCOUNT"
          },
          "description" : ""
        }, {
          "target" : "TAX",
          "expression" : {
            "format" : "sql",
            "expression" : "TAX"
          },
          "description" : ""
        }, {
          "target" : "RETURNFLAG",
          "expression" : {
            "format" : "sql",
            "expression" : "RETURNFLAG"
          },
          "description" : ""
        }, {
          "target" : "DELIVERYSTATUS",
          "expression" : {
            "format" : "sql",
            "expression" : "DELIVERYSTATUS"
          },
          "description" : ""
        }, {
          "target" : "CLEARANCE",
          "expression" : {
            "format" : "sql",
            "expression" : "case when (\n    DISCOUNT > 0.06\n)\nor (\n    RETURNFLAG is true\n) then 'true' else 'false' end"
          },
          "description" : ""
        }, {
          "target" : "ORDERKEY",
          "expression" : {
            "format" : "sql",
            "expression" : "ORDERKEY"
          },
          "description" : ""
        }, {
          "target" : "CUSTKEY",
          "expression" : {
            "format" : "sql",
            "expression" : "CUSTKEY"
          },
          "description" : ""
        } ],
        "importString" : "",
        "activeTab" : "expressions",
        "columnsSelector" : [ "8mYWUkw15f4mTJoUR2shi$$dKaIoa9L3vS6Zkgi-6nSm##TAX", "8mYWUkw15f4mTJoUR2shi$$dKaIoa9L3vS6Zkgi-6nSm##QUANTITY", "8mYWUkw15f4mTJoUR2shi$$dKaIoa9L3vS6Zkgi-6nSm##EXTENDEDPRICE", "8mYWUkw15f4mTJoUR2shi$$dKaIoa9L3vS6Zkgi-6nSm##RETURNFLAG", "8mYWUkw15f4mTJoUR2shi$$dKaIoa9L3vS6Zkgi-6nSm##CUSTKEY", "8mYWUkw15f4mTJoUR2shi$$dKaIoa9L3vS6Zkgi-6nSm##ORDERKEY", "8mYWUkw15f4mTJoUR2shi$$dKaIoa9L3vS6Zkgi-6nSm##DELIVERYSTATUS", "8mYWUkw15f4mTJoUR2shi$$dKaIoa9L3vS6Zkgi-6nSm##DISCOUNT", "8mYWUkw15f4mTJoUR2shi$$dKaIoa9L3vS6Zkgi-6nSm##MKTSEGMENT" ]
      }
    },
    "NVq4EgexCYu3mIc-NjHCB$$Mvz2FewliukpPG0Nvu3_K" : {
      "id" : "NVq4EgexCYu3mIc-NjHCB$$Mvz2FewliukpPG0Nvu3_K",
      "component" : "Source",
      "metadata" : {
        "label" : "Orders",
        "slug" : "Orders",
        "x" : 120,
        "y" : 320,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "qwAmYOpKWTXscld6t9gzz$$UZIlvNxKFPa1NO65Y2Y4B",
          "slug" : "out",
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "datasetId" : "datasets/OrdersNCustomers"
      }
    },
    "8Mp3C9BE6TOABTp8JkZNb$$XPitnhS67-102QlrAEufe" : {
      "id" : "8Mp3C9BE6TOABTp8JkZNb$$XPitnhS67-102QlrAEufe",
      "component" : "Aggregate",
      "metadata" : {
        "label" : "SumAmounts",
        "slug" : "SumAmounts",
        "x" : 920,
        "y" : 220,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "JUsR1yMs0Gr4ourpvsl56$$mc4zYqS2Q7Y-pwUhSoURn",
          "slug" : "in0",
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "804K7Hsv2AhZpXLmz6m2b$$7M7_HKyAaQRpqhUm7V_It",
          "slug" : "out",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "RETURNFLAG",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "DELIVERYSTATUS",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "SUM_QTY",
              "type" : "decimal(22,2)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "AVG_QTY",
              "type" : "decimal(18,2)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "SUM_CHARGE",
              "type" : "decimal(18,2)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "COUNT_ITEM",
              "type" : "long",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true
      },
      "properties" : {
        "allIns" : false,
        "doPivot" : false,
        "aggregate" : [ {
          "target" : "SUM_QTY",
          "expression" : {
            "format" : "sql",
            "expression" : "sum(QUANTITY) "
          },
          "description" : "",
          "_row_id" : ""
        }, {
          "target" : "AVG_QTY",
          "expression" : {
            "format" : "sql",
            "expression" : "cast(avg(QUANTITY)as decimal (18,2))"
          },
          "description" : "",
          "_row_id" : ""
        }, {
          "target" : "SUM_CHARGE",
          "expression" : {
            "format" : "sql",
            "expression" : "cast(\n  sum(\n    EXTENDEDPRICE * (1 - DISCOUNT) * (1 + TAX)\n  )\n as decimal (18,2))"
          },
          "description" : "",
          "_row_id" : ""
        }, {
          "target" : "COUNT_ITEM",
          "expression" : {
            "format" : "sql",
            "expression" : "count(*)"
          },
          "description" : "",
          "_row_id" : ""
        } ],
        "allowSelection" : true,
        "pivotColumn" : null,
        "pivotValues" : [ ],
        "activeTab" : "aggregate",
        "columnsSelector" : [ "JUsR1yMs0Gr4ourpvsl56$$mc4zYqS2Q7Y-pwUhSoURn##TAX", "JUsR1yMs0Gr4ourpvsl56$$mc4zYqS2Q7Y-pwUhSoURn##EXTENDEDPRICE", "JUsR1yMs0Gr4ourpvsl56$$mc4zYqS2Q7Y-pwUhSoURn##DELIVERYSTATUS", "JUsR1yMs0Gr4ourpvsl56$$mc4zYqS2Q7Y-pwUhSoURn##RETURNFLAG", "JUsR1yMs0Gr4ourpvsl56$$mc4zYqS2Q7Y-pwUhSoURn##DISCOUNT", "JUsR1yMs0Gr4ourpvsl56$$mc4zYqS2Q7Y-pwUhSoURn##QUANTITY" ],
        "groupBy" : [ {
          "target" : "RETURNFLAG",
          "expression" : {
            "format" : "sql",
            "expression" : "RETURNFLAG"
          },
          "description" : "",
          "_row_id" : null
        }, {
          "target" : "DELIVERYSTATUS",
          "expression" : {
            "format" : "sql",
            "expression" : "DELIVERYSTATUS"
          },
          "description" : "",
          "_row_id" : null
        } ]
      }
    },
    "9fSCN0grbscwa97q59qKI$$CpZXGIhBeWCJRAcYEOYn9" : {
      "id" : "9fSCN0grbscwa97q59qKI$$CpZXGIhBeWCJRAcYEOYn9",
      "component" : "Join",
      "metadata" : {
        "label" : "ByOrderkey",
        "slug" : "ByOrderkey",
        "x" : 320,
        "y" : 220,
        "phase" : 0,
        "cache" : true,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "aXbN0dcD-ZxUkNDYa3_I6$$xz4NGyhsEi_iSkd7Bv5ly",
          "slug" : "in0",
          "isStreaming" : false
        }, {
          "id" : "zrK5UhFFLBsK-abtuP7Fg$$es16pY48O2Fub7WYHczkZ",
          "slug" : "in1",
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "JxRAoGF1_Bycx2nLf_myo$$dlGCSqxxQCmI1sWbqKHQo",
          "slug" : "out",
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "in1",
          "expression" : {
            "format" : "sql",
            "expression" : "in0.ORDERKEY = in1.O_ORDERKEY"
          },
          "joinType" : "inner"
        } ],
        "expressions" : [ {
          "target" : "MKTSEGMENT",
          "expression" : {
            "format" : "sql",
            "expression" : "in1.C_MKTSEGMENT"
          },
          "description" : "",
          "_row_id" : ""
        }, {
          "target" : "QUANTITY",
          "expression" : {
            "format" : "sql",
            "expression" : "in0.QUANTITY"
          },
          "description" : "",
          "_row_id" : ""
        }, {
          "target" : "EXTENDEDPRICE",
          "expression" : {
            "format" : "sql",
            "expression" : "in0.EXTENDEDPRICE"
          },
          "description" : "",
          "_row_id" : ""
        }, {
          "target" : "DISCOUNT",
          "expression" : {
            "format" : "sql",
            "expression" : "in0.DISCOUNT"
          },
          "description" : "",
          "_row_id" : ""
        }, {
          "target" : "TAX",
          "expression" : {
            "format" : "sql",
            "expression" : "in0.TAX"
          },
          "description" : "",
          "_row_id" : ""
        }, {
          "target" : "RETURNFLAG",
          "expression" : {
            "format" : "sql",
            "expression" : "in0.RETURNFLAG"
          },
          "description" : "",
          "_row_id" : ""
        }, {
          "target" : "DELIVERYSTATUS",
          "expression" : {
            "format" : "sql",
            "expression" : "in0.DELIVERYSTATUS"
          },
          "description" : "",
          "_row_id" : ""
        }, {
          "target" : "CUSTKEY",
          "expression" : {
            "format" : "sql",
            "expression" : "in1.C_CUSTKEY"
          },
          "description" : "",
          "_row_id" : ""
        }, {
          "target" : "ORDERKEY",
          "expression" : {
            "format" : "sql",
            "expression" : "in1.O_ORDERKEY"
          },
          "description" : "",
          "_row_id" : ""
        } ],
        "hints" : [ {
          "id" : "aXbN0dcD-ZxUkNDYa3_I6$$xz4NGyhsEi_iSkd7Bv5ly",
          "alias" : "in0",
          "hintType" : "none",
          "propagateColumns" : false
        }, {
          "id" : "zrK5UhFFLBsK-abtuP7Fg$$es16pY48O2Fub7WYHczkZ",
          "alias" : "in1",
          "hintType" : "none",
          "propagateColumns" : false
        } ],
        "allIn1" : null,
        "activeTab" : "expressions",
        "columnsSelector" : [ "zrK5UhFFLBsK-abtuP7Fg$$es16pY48O2Fub7WYHczkZ##O_ORDERKEY", "aXbN0dcD-ZxUkNDYa3_I6$$xz4NGyhsEi_iSkd7Bv5ly##ORDERKEY", "zrK5UhFFLBsK-abtuP7Fg$$es16pY48O2Fub7WYHczkZ##C_CUSTKEY", "aXbN0dcD-ZxUkNDYa3_I6$$xz4NGyhsEi_iSkd7Bv5ly##DELIVERYSTATUS", "aXbN0dcD-ZxUkNDYa3_I6$$xz4NGyhsEi_iSkd7Bv5ly##EXTENDEDPRICE", "aXbN0dcD-ZxUkNDYa3_I6$$xz4NGyhsEi_iSkd7Bv5ly##QUANTITY", "aXbN0dcD-ZxUkNDYa3_I6$$xz4NGyhsEi_iSkd7Bv5ly##RETURNFLAG", "aXbN0dcD-ZxUkNDYa3_I6$$xz4NGyhsEi_iSkd7Bv5ly##TAX", "zrK5UhFFLBsK-abtuP7Fg$$es16pY48O2Fub7WYHczkZ##O_ORDERKEY", "aXbN0dcD-ZxUkNDYa3_I6$$xz4NGyhsEi_iSkd7Bv5ly##DISCOUNT", "zrK5UhFFLBsK-abtuP7Fg$$es16pY48O2Fub7WYHczkZ##C_MKTSEGMENT" ],
        "allIn0" : null,
        "whereClause" : null,
        "headAlias" : "in0"
      }
    },
    "DesAMchieghr2sS4gP4Cj$$C7SZDqP8IFHYQ_JXwAQzw" : {
      "id" : "DesAMchieghr2sS4gP4Cj$$C7SZDqP8IFHYQ_JXwAQzw",
      "component" : "Source",
      "metadata" : {
        "label" : "Shipments",
        "slug" : "Shipments",
        "x" : 120,
        "y" : 120,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "5ch4yV0S7OkxoYIXikemj$$yQEEnliTmItccOXmjMJjJ",
          "slug" : "out",
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "datasetId" : "datasets/Shipments"
      }
    },
    "QHraJwix6MU4zkcR2JcAh$$1WegjhqC0sBHI7lizd57N" : {
      "id" : "QHraJwix6MU4zkcR2JcAh$$1WegjhqC0sBHI7lizd57N",
      "component" : "Target",
      "metadata" : {
        "label" : "Pricing",
        "slug" : "Pricing",
        "x" : 1120,
        "y" : 220,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "jmtRAGkFjovY3at-MWOey$$gJQQztgCLMHHZY8oVIJXo",
          "slug" : "in0",
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "datasetId" : "datasets/Pricing"
      }
    }
  },
  "ports" : {
    "inputs" : [ ],
    "outputs" : [ ],
    "selectedInputFields" : [ ],
    "isCustomOutputSchema" : false
  }
}